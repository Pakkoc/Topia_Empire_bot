# 내전 시스템 사용 가이드

> 다양한 게임 유형별 내전 생성 및 운영 방법

## 목차

1. [시스템 개요](#시스템-개요)
2. [기본 설정](#기본-설정)
3. [카테고리 설정](#카테고리-설정)
4. [게임 유형별 가이드](#게임-유형별-가이드)
   - [롤 5:5 내전](#롤-55-내전)
   - [롤토체스 (TFT)](#롤토체스-tft)
   - [배틀그라운드](#배틀그라운드)
   - [발로란트](#발로란트)
   - [커스텀 게임](#커스텀-게임)
5. [운영 플로우](#운영-플로우)
6. [보상 정산 로직](#보상-정산-로직)

---

## 시스템 개요

내전 시스템은 참가비 기반의 게임 대회 시스템입니다.

### 핵심 기능

- **참가비 자동 차감**: 참가 시 토피 자동 차감
- **팀 배정**: 관리자가 참가자를 팀별로 배정
- **순위별 보상**: 경기 종료 후 순위에 따른 자동 보상
- **카테고리 지원**: 게임별 사전 설정 가능

### 지원 범위

| 항목 | 범위 |
|------|------|
| 팀 수 | 2 ~ 100팀 |
| 순위 보상 | 1등 ~ N등 (무제한) |
| 팀당 인원 | 1 ~ 25명 (설정 가능) |

---

## 기본 설정

### 웹 대시보드 설정

1. **대시보드** → **화폐 시스템** → **내전 시스템**
2. 기본 설정:
   - **참가비**: 기본 참가비 (예: 100 토피)
   - **관리자 역할**: 내전 생성 권한 역할
   - **순위별 보상 비율**: 기본값 (1등 50%, 2등 30%, 3등 15%, 4등 5%)

### 패널 설치

1. 패널 채널 선택
2. "패널 설치" 클릭
3. 디스코드 채널에 내전 패널 메시지 생성됨

---

## 카테고리 설정

카테고리를 미리 만들어두면 빠르게 내전을 생성할 수 있습니다.

### 카테고리 생성 예시

| 카테고리명 | 팀 수 | 팀당 인원 | 승자독식 | 비고 |
|-----------|-------|----------|---------|------|
| 롤 5:5 | 2팀 | 5명 | ✅ | 1등 100%, 2등 0% |
| 롤토체스 듀오 | 4팀 | 2명 | ❌ | 1~4등 보상 |
| 롤토체스 솔로 | 8팀 | 1명 | ❌ | 1~4등 보상 |
| 배그 스쿼드 | 25팀 | 4명 | ❌ | 커스텀 순위 보상 |
| 발로란트 | 2팀 | 5명 | ✅ | 1등 100%, 2등 0% |

---

## 게임 유형별 가이드

### 롤 5:5 내전

가장 기본적인 2팀 대결 형식입니다.

#### 설정

```
카테고리명: 롤 5:5
팀 수: 2
팀당 최대 인원: 5
승자독식: ✅ (1등 100%, 2등 0%)
```

#### 운영 순서

1. **내전 생성**
   - 패널에서 "롤 5:5" 카테고리 선택
   - 제목 입력 (예: "롤 내전 1차")

2. **참가 모집**
   - 참가자들이 "참가" 버튼 클릭
   - 최대 10명까지 참가 가능

3. **팀 배정**
   - 관리자가 각 참가자를 1팀/2팀으로 배정
   - 또는 "자동 배정"으로 무작위 배정

4. **경기 진행**
   - "경기 시작" 클릭
   - 실제 게임 진행

5. **결과 입력**
   - "경기 종료" 클릭
   - 1등 팀 선택 (2등은 자동 설정)
   - 보상 자동 지급

#### 보상 예시

```
참가비: 100 토피 × 10명 = 1,000 토피 상금풀

1등 (5명): 1,000 토피 ÷ 5명 = 200 토피/인
2등 (5명): 0 토피
```

---

### 롤토체스 (TFT)

개인전 또는 듀오 형식의 순위 게임입니다.

#### 솔로 모드 (8인)

```
카테고리명: 롤토체스 솔로
팀 수: 8
팀당 최대 인원: 1
승자독식: ❌
순위 보상:
  1등: 40%
  2등: 25%
  3등: 20%
  4등: 15%
```

#### 듀오 모드 (4팀)

```
카테고리명: 롤토체스 듀오
팀 수: 4
팀당 최대 인원: 2
승자독식: ❌
순위 보상:
  1등: 50%
  2등: 30%
  3등: 15%
  4등: 5%
```

#### 운영 순서

1. **내전 생성**
   - 카테고리 선택 (솔로/듀오)
   - 제목 입력

2. **참가 모집**
   - 솔로: 8명 모집
   - 듀오: 8명 모집 (4팀 × 2명)

3. **팀 배정**
   - 솔로: 각 참가자를 1~8팀에 배정
   - 듀오: 2명씩 1~4팀에 배정

4. **경기 종료**
   - 순위 선택 (1~4등)
   - 각 순위에 해당하는 팀 지정

#### 보상 예시 (솔로, 참가비 100)

```
상금풀: 100 × 8명 = 800 토피

1등: 800 × 40% = 320 토피
2등: 800 × 25% = 200 토피
3등: 800 × 20% = 160 토피
4등: 800 × 15% = 120 토피
```

---

### 배틀그라운드

대규모 팀 기반 배틀로얄 게임입니다.

#### 스쿼드 모드 (25팀)

```
카테고리명: 배그 스쿼드
팀 수: 25
팀당 최대 인원: 4
승자독식: ❌
순위 보상:
  1등: 30%
  2등: 20%
  3등: 15%
  4등: 10%
  5등: 8%
  6등: 6%
  7등: 5%
  8등: 3%
  9등: 2%
  10등: 1%
```

#### 운영 순서

1. **내전 생성**
   - "배그 스쿼드" 카테고리 선택
   - 제목 입력

2. **참가 모집**
   - 최대 100명 참가 (25팀 × 4명)

3. **팀 배정**
   - 4명씩 1~25팀에 배정
   - 파티 단위 참가자는 같은 팀으로

4. **경기 종료**
   - 상위 10개 팀 순위 입력
   - 나머지 팀은 보상 없음

#### 보상 예시 (참가비 100, 100명 참가)

```
상금풀: 100 × 100명 = 10,000 토피

1등 (4명): 10,000 × 30% ÷ 4 = 750 토피/인
2등 (4명): 10,000 × 20% ÷ 4 = 500 토피/인
3등 (4명): 10,000 × 15% ÷ 4 = 375 토피/인
...
10등 (4명): 10,000 × 1% ÷ 4 = 25 토피/인
```

---

### 발로란트

5:5 FPS 대결 형식입니다.

#### 설정

```
카테고리명: 발로란트
팀 수: 2
팀당 최대 인원: 5
승자독식: ✅
```

롤 5:5와 동일한 방식으로 운영됩니다.

---

### 커스텀 게임

카테고리 없이 직접 설정하는 방식입니다.

#### 생성 방법

1. 패널에서 "직접 입력" 선택
2. 제목 입력
3. 팀 수 입력 (2~100)

#### 보상 설정

직접 입력 시 전역 설정의 보상 비율이 적용됩니다.
- 2팀: 자동으로 승자독식 (100:0)
- 3팀 이상: 전역 설정 비율 사용

---

## 운영 플로우

### 전체 흐름

```
[패널] → [내전 생성] → [참가 모집] → [팀 배정] → [경기 시작] → [경기 종료] → [보상 지급]
```

### 상세 단계

#### 1. 내전 생성

```
관리자가 패널에서:
- 카테고리 선택 또는 직접 입력
- 제목 입력
→ 내전 메시지 생성됨
```

#### 2. 참가 모집

```
참가자가:
- "참가" 버튼 클릭
- 참가비 자동 차감
- 참가자 목록에 추가됨

관리자가:
- 참가자 관리 (강퇴 등)
- 모집 상태 확인
```

#### 3. 팀 배정

```
관리자가:
- 각 참가자를 팀에 배정
- 또는 "자동 배정" 사용
→ 모든 참가자 배정 완료 필요
```

#### 4. 경기 시작

```
관리자가:
- "경기 시작" 클릭
→ 상태가 "경기중"으로 변경
→ 참가/취소 불가
```

#### 5. 경기 종료

```
관리자가:
- "경기 종료" 클릭
- 순위별 팀 선택
→ 보상 자동 계산 및 지급
→ 거래 기록 저장
```

### 취소 처리

```
경기 시작 전:
- 관리자가 "취소" 클릭
→ 모든 참가자에게 참가비 환불
```

---

## 보상 정산 로직

### 기본 공식

```
팀 보상 = 상금풀 × 순위 비율
1인당 보상 = 팀 보상 ÷ 팀 인원수
```

### 순위 비율 정규화

실제 사용되는 순위만 비율을 재계산합니다.

**예시**: 3팀 게임에서 1~4등 비율이 설정된 경우

```
원본 비율: 1등 50%, 2등 30%, 3등 15%, 4등 5%
사용 순위: 1등, 2등, 3등 (3팀이므로)
합계: 50 + 30 + 15 = 95%

정규화:
- 1등: 50 ÷ 95 × 100 = 52.6%
- 2등: 30 ÷ 95 × 100 = 31.6%
- 3등: 15 ÷ 95 × 100 = 15.8%
```

### 2팀 승자독식

2팀 게임은 기본적으로 승자독식입니다.

```
1등: 100%
2등: 0%
```

카테고리에서 `승자독식: ❌`로 설정하면 일반 비율 적용됩니다.

---

## 디스코드 명령어

### 슬래시 명령어

| 명령어 | 설명 |
|-------|------|
| `/내전설정` | 내전 시스템 설정 |
| `/내전패널` | 내전 패널 설치 |

### 버튼 인터랙션

- **참가**: 내전 참가 (참가비 차감)
- **취소**: 참가 취소 (참가비 환불)
- **팀 배정**: 관리자용 팀 배정
- **경기 시작**: 경기 시작
- **경기 종료**: 순위 입력 및 보상 지급
- **내전 취소**: 전체 취소 및 환불

---

## FAQ

### Q: 참가비 없이 내전을 열 수 있나요?

A: 네, 참가비를 0으로 설정하면 무료 내전이 가능합니다. 단, 보상도 없습니다.

### Q: 팀 수를 나중에 변경할 수 있나요?

A: 내전 생성 후에는 변경할 수 없습니다. 새로 생성해야 합니다.

### Q: 참가자가 중도 탈퇴하면?

A: 경기 시작 전에는 취소 버튼으로 환불 가능합니다. 경기 시작 후에는 불가합니다.

### Q: 동일 순위(공동 1등)는 어떻게 처리하나요?

A: 현재는 지원하지 않습니다. 각 순위에 하나의 팀만 배정 가능합니다.

### Q: 순위 비율 합이 100%가 아니면?

A: 100%가 되도록 자동 정규화됩니다. 설정 시 100%로 맞추는 것을 권장합니다.
